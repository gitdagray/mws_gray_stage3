async function sendNewReview(){try{let e=self.restaurant.id,t=document.getElementById("newRevName").value,n=document.getElementById("newRevRating").value,r=document.getElementById("newRevComments").value;const a=await fetch("http://localhost:1337/reviews/",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({restaurant_id:e,name:t,rating:n,comments:r})}),i=await a.json();console.log("myRevReply: "+JSON.stringify(i)),showReviewThankYou(t)}catch(e){console.log("Post failed."),console.error(e)}}let restaurant,reviews;var map;"serviceWorker"in navigator&&navigator.serviceWorker.register("sw.js").then(function(){console.log("Service Worker Registered!")}).catch(e=>{console.log(e)}),getFullDate=(e=>{const t=new Date(e);return t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()}),document.getElementById("map-link").addEventListener("click",e=>{document.getElementById("map-link-option").style.display="none";document.getElementById("map-container").style.display="block",initMap()}),mapDecisions=(()=>{({width:window.innerWidth||document.body.clientWidth,height:window.innerHeight||document.body.clientHeight}).width<801?fetchRestaurantFromURL((e,t)=>{e?console.error(e):(fillBreadcrumb(),fetchRestaurantReviewsFromURL((e,t)=>{e&&console.error(e)}))}):document.getElementById("map-link").click()}),window.initMap=(()=>{fetchRestaurantFromURL((e,t)=>{e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map),google.maps.event.addListenerOnce(map,"idle",()=>{document.getElementsByTagName("iframe")[0].title="Google Maps"}),fetchRestaurantReviewsFromURL((e,t)=>{e&&console.error(e)}))})}),fetchRestaurantFromURL=(e=>{if(self.restaurant)return void e(null,self.restaurant);const t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,(t,n)=>{self.restaurant=n,n?(fillRestaurantHTML(),e(null,n)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),fillRestaurantHTML=((e=self.restaurant)=>{document.getElementById("headline-holder");document.getElementById("restaurant-name").innerHTML=e.name;const t=document.getElementById("like-button-holder"),n=!(!e.is_favorite||"true"!==e.is_favorite.toString()),r=document.createElement("button");r.className="fave-rest-icon";const a=document.createAttribute("tabindex");a.value=0,r.setAttributeNode(a);const i=document.createAttribute("aria-label");i.value=n?e.name+" is a favorite.":e.name+" is not a favorite.",r.setAttributeNode(i),r.id="fave-rest-icon-"+e.id,r.style.background=n?'url("img/icons/like.svg") no-repeat':'url("img/icons/like-not.svg") no-repeat',r.onclick=(t=>handleLikeButtonClick(e.id,!n)),t.append(r);const o=document.getElementById("restaurant-address");o.innerHTML=e.address;const u=document.createAttribute("aria-label");u.value="The address for "+e.name+" is "+e.address+".",o.setAttributeNode(u);const d=document.getElementById("restaurant-img");d.className="restaurant-img",d.src=DBHelper.imageUrlForRestaurant(e)+"_800.jpg",d.sizes="(max-width: 400px) 100vw, (min-width: 401px) 50vw",d.srcset=DBHelper.imageUrlForRestaurant(e)+"_400.jpg 400w, "+DBHelper.imageUrlForRestaurant(e)+"_800.jpg 800w",d.title=e.name,d.alt="Image of the "+e.name+" restaurant.";const l=document.getElementById("restaurant-cuisine");l.innerHTML=e.cuisine_type;const c=document.createAttribute("aria-label");c.value="Cuisine type of "+e.name+" is "+e.cuisine_type+".",l.setAttributeNode(c),e.operating_hours&&fillRestaurantHoursHTML()}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");for(let n in e){const r=document.createElement("tr"),a=document.createElement("th");a.innerHTML=n;const i=document.createAttribute("scope"),o=document.createAttribute("tabindex");i.value="row",o.value=0,a.setAttributeNode(i),a.setAttributeNode(o),r.appendChild(a);const u=document.createElement("td"),d=document.createAttribute("tabindex");u.innerHTML=e[n],d.value=0,u.setAttributeNode(d),r.appendChild(u),t.appendChild(r)}}),fetchRestaurantReviewsFromURL=(e=>{if(self.reviews)return void e(null,self.reviews);const t=self.restaurant.id;t?DBHelper.fetchReviewsByRestaurantId(t,(t,n)=>{self.reviews=n,n?(fillReviewsHTML(),e(null,n)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),fillReviewsHTML=((e=self.reviews)=>{const t=document.getElementById("reviews-container"),n=document.createElement("h3"),r=document.createAttribute("tabindex");n.innerHTML="Reviews",r.value=0,n.setAttributeNode(r),t.appendChild(n);const a=document.createElement("button");a.innerHTML="Add A New Review for<br>"+self.restaurant.name;const i=document.createAttribute("id"),o=document.createAttribute("tabindex"),u=document.createAttribute("aria-label");i.value="new-review-button",o.value=0,u.value="Press button to add a new review for "+self.restaurant.name,a.setAttributeNode(i),a.setAttributeNode(o),a.setAttributeNode(u),t.appendChild(a);const d=document.createElement("form"),l=document.createAttribute("id"),c=document.createAttribute("name"),s=document.createAttribute("onsubmit");l.value="new-review-form",c.value="newReviewForm",s.value="validateNewReview()",d.setAttributeNode(l),d.setAttributeNode(l),d.setAttributeNode(c),t.appendChild(d);const m=document.getElementById("new-review-form"),b=document.createElement("p"),v=document.createAttribute("tabindex"),A=document.createAttribute("id");v.value=0,A.value="thankYou",b.setAttributeNode(v),b.setAttributeNode(A),t.appendChild(b);const p=document.createElement("label");p.innerHTML="Please enter your name:";const w=document.createAttribute("id"),g=document.createAttribute("for");w.value="newRevNameLabel",g.value="newRevName",p.setAttributeNode(w),p.setAttributeNode(g),m.appendChild(p);const h=document.createElement("input"),f=document.createAttribute("tabindex"),N=document.createAttribute("id"),R=document.createAttribute("aria-labelledby"),y=document.createAttribute("type"),E=document.createAttribute("name"),L=document.createAttribute("placeholder"),B=document.createAttribute("maxlength"),C=document.createAttribute("required");f.value=0,N.value="newRevName",R.value="newRevNameLabel",y.value="text",E.value="revname",L.value="Your Name",B.value=20,h.setAttributeNode(f),h.setAttributeNode(N),h.setAttributeNode(R),h.setAttributeNode(y),h.setAttributeNode(E),h.setAttributeNode(L),h.setAttributeNode(B),h.setAttributeNode(C),m.appendChild(h);const H=document.createElement("label");H.innerHTML="Please choose a rating:";const T=document.createAttribute("id"),k=document.createAttribute("for");T.value="newRevRatingLabel",k.value="newRevRating",H.setAttributeNode(T),H.setAttributeNode(k),m.appendChild(H);const M=document.createElement("select"),I=document.createAttribute("tabindex"),x=document.createAttribute("id"),F=document.createAttribute("name"),D=document.createAttribute("aria-labelledby");I.value=0,x.value="newRevRating",F.value="newRevRating",D.value="newRevRatingLabel",M.setAttributeNode(I),M.setAttributeNode(x),M.setAttributeNode(F),M.setAttributeNode(D),m.appendChild(M);const U=document.getElementById("newRevRating"),_=document.createElement("option"),P=document.createElement("option"),S=document.createElement("option"),Y=document.createElement("option"),j=document.createElement("option");_.innerHTML="5: Awesome!",P.innerHTML="4: Above Average",S.innerHTML="3: Average",Y.innerHTML="2: Below Average",j.innerHTML="1: Awful";const W=document.createAttribute("value"),O=document.createAttribute("value"),$=document.createAttribute("value"),J=document.createAttribute("value"),z=document.createAttribute("value"),q=document.createAttribute("selected");W.value=5,O.value=4,$.value=3,J.value=2,z.value=1,_.setAttributeNode(W),_.setAttributeNode(q),P.setAttributeNode(O),S.setAttributeNode($),Y.setAttributeNode(J),j.setAttributeNode(z),U.appendChild(_),U.appendChild(P),U.appendChild(S),U.appendChild(Y),U.appendChild(j);const G=document.createElement("label");G.innerHTML="Review Comments:";const K=document.createAttribute("id"),Q=document.createAttribute("for");K.value="newRevCommentsLabel",Q.value="newRevComments",G.setAttributeNode(K),G.setAttributeNode(Q),m.appendChild(G);const V=document.createElement("textarea"),X=document.createAttribute("tabindex"),Z=document.createAttribute("id"),ee=document.createAttribute("aria-labelledby"),te=document.createAttribute("name"),ne=document.createAttribute("maxlength");X.value=0,Z.value="newRevComments",ee.value="newRevCommentsLabel",te.value="revcomments",ne.value=250,V.setAttributeNode(X),V.setAttributeNode(Z),V.setAttributeNode(ee),V.setAttributeNode(te),V.setAttributeNode(ne),m.appendChild(V);const re=document.createElement("button");re.innerHTML="Submit A New Review for<br>"+self.restaurant.name;const ae=document.createAttribute("id"),ie=document.createAttribute("tabindex"),oe=document.createAttribute("aria-label");if(ae.value="sub-review-button",ie.value=0,oe.value="Press this button to add a new review for "+self.restaurant.name,re.setAttributeNode(ae),re.setAttributeNode(ie),re.setAttributeNode(oe),m.appendChild(re),document.getElementById("new-review-button").addEventListener("click",()=>{document.getElementById("new-review-form").style.display="block",document.getElementById("new-review-button").style.display="none"}),document.getElementById("new-review-form").addEventListener("submit",e=>{e.preventDefault();const t=self.restaurant.id,n=document.getElementById("newRevName").value,r=document.getElementById("newRevRating").value,a=document.getElementById("newRevComments").value;"serviceWorker"in navigator&&"SyncManager"in window?navigator.serviceWorker.ready.then(e=>{const i={restaurant_id:t,name:n,rating:r,comments:a};console.log("newReviewData: "+JSON.stringify(i)),writeData("sync-newRev",i).then(()=>e.sync.register("sync-new-review")).then(showReviewThankYou(n)).catch(e=>console.log(e))}):sendNewReview()}),!e){const e=document.createElement("p");return e.innerHTML="No reviews yet!",void t.appendChild(e)}const ue=document.getElementById("reviews-list");e.forEach(e=>{ue.appendChild(createReviewHTML(e))}),t.appendChild(ue)}),createReviewHTML=(e=>{const t=document.createElement("li"),n=document.createElement("div"),r=document.createAttribute("class"),a=document.createAttribute("aria-label"),i=document.createAttribute("tabindex");n.innerHTML=e.name,r.value="review-name",a.value="Review by "+e.name+".",i.value=0,n.setAttributeNode(r),n.setAttributeNode(a),n.setAttributeNode(i),t.appendChild(n);const o=document.createElement("div"),u=document.createAttribute("class"),d=document.createAttribute("aria-label"),l=document.createAttribute("tabindex"),c=getFullDate(e.updatedAt);o.innerHTML=c,u.value="review-date",d.value="Review posted on "+c+".",l.value=0,o.setAttributeNode(u),o.setAttributeNode(d),o.setAttributeNode(l),t.appendChild(o);const s=document.createElement("div"),m=document.createAttribute("class"),b=document.createAttribute("aria-label"),v=document.createAttribute("tabindex");s.innerHTML=`Rating: ${e.rating}`,m.value="review-rating",b.value=e.name+" gave a rating of "+e.rating+".",v.value=0,s.setAttributeNode(m),s.setAttributeNode(b),s.setAttributeNode(v),t.appendChild(s);const A=document.createElement("p"),p=document.createAttribute("class"),w=document.createAttribute("tabindex");return A.innerHTML=e.comments,p.value="review-comments",w.value=0,A.setAttributeNode(p),A.setAttributeNode(w),t.appendChild(A),t}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}),showReviewThankYou=(e=>{document.getElementById("thankYou").innerHTML="Thank you for submitting a review "+e+"!",document.getElementById("thankYou").style.display="block",document.getElementById("new-review-form").style.display="none"}),handleLikeButtonClick=((e,t)=>{const n=document.getElementById("fave-rest-icon-"+e);self.restaurant.is_favorite=t,n.style.background=t?'url("img/icons/like.svg") no-repeat':'url("img/icons/like-not.svg") no-repeat',t?n.setAttribute("aria-label",self.restaurant.name+" is a favorite."):n.setAttribute("aria-label",self.restaurant.name+" is not a favorite."),n.onclick=(n=>handleLikeButtonClick(e,!t)),handleFaveClick(e,t)});