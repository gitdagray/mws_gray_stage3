async function sendNewReview(){try{let e=self.restaurant.id,t=document.getElementById("newRevName").value,n=document.getElementById("newRevRating").value,a=document.getElementById("newRevComments").value;const r=await fetch("http://localhost:1337/reviews/",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({restaurant_id:e,name:t,rating:n,comments:a})}),i=await r.json();console.log("myRevReply: "+JSON.stringify(i)),showReviewThankYou(t)}catch(e){console.log("Post failed."),console.error(e)}}let restaurant,reviews;var map;"serviceWorker"in navigator&&navigator.serviceWorker.register("sw.js").then(function(){console.log("Service Worker Registered!")}).catch(e=>{console.log(e)}),getFullDate=(e=>{const t=new Date(e);return t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()}),document.getElementById("map-link").addEventListener("click",e=>{document.getElementById("map-link-option").style.display="none";document.getElementById("map-container").style.display="block"}),window.onload=(()=>{({width:window.innerWidth||document.body.clientWidth,height:window.innerHeight||document.body.clientHeight}).width>800&&document.getElementById("map-link").click(),fetchRestaurantFromURL((e,t)=>{e?console.error(e):(fillBreadcrumb(),initMap(t),fetchRestaurantReviewsFromURL((e,t)=>{e&&console.error(e)}))})}),window.initMap=(e=>{const t=document.getElementById("map"),n=document.createAttribute("src"),a=document.createAttribute("alt"),r=document.createAttribute("tabindex"),i=e.latlng.lat+","+e.latlng.lng;let o="https://maps.googleapis.com/maps/api/staticmap?center=";o=(o=o+i+"&zoom=16&size=640x640&scale=1&markers=color:red%7C")+i+"&key=AIzaSyA8iJ1AVyPPTXTKUDzwY8jrB04Ndhdxy0Q",n.value=o,a.value="A map for "+e.name,r.value=0,t.setAttributeNode(n),t.setAttributeNode(a),t.setAttributeNode(r)}),fetchRestaurantFromURL=(e=>{if(self.restaurant)return void e(null,self.restaurant);const t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,(t,n)=>{self.restaurant=n,n?(fillRestaurantHTML(),e(null,n)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),fillRestaurantHTML=((e=self.restaurant)=>{document.getElementById("headline-holder");document.getElementById("restaurant-name").innerHTML=e.name;const t=document.getElementById("like-button-holder"),n=!(!e.is_favorite||"true"!==e.is_favorite.toString()),a=document.createElement("button");a.className="fave-rest-icon";const r=document.createAttribute("tabindex");r.value=0,a.setAttributeNode(r);const i=document.createAttribute("aria-label");i.value=n?e.name+" is a favorite.":e.name+" is not a favorite.",a.setAttributeNode(i),a.id="fave-rest-icon-"+e.id,a.style.background=n?'url("img/icons/like.svg") no-repeat':'url("img/icons/like-not.svg") no-repeat',a.onclick=(t=>handleLikeButtonClick(e.id,!n)),t.append(a);const o=document.getElementById("restaurant-address");o.innerHTML=e.address;const u=document.createAttribute("aria-label");u.value="The address for "+e.name+" is "+e.address+".",o.setAttributeNode(u);const d=document.getElementById("restaurant-img");d.className="restaurant-img",d.src=DBHelper.imageUrlForRestaurant(e)+"_800.jpg",d.sizes="(max-width: 400px) 100vw, (min-width: 401px) 50vw",d.srcset=DBHelper.imageUrlForRestaurant(e)+"_400.jpg 400w, "+DBHelper.imageUrlForRestaurant(e)+"_800.jpg 800w",d.title=e.name,d.alt="Image of the "+e.name+" restaurant.";const l=document.getElementById("restaurant-cuisine");l.innerHTML=e.cuisine_type;const c=document.createAttribute("aria-label");c.value="Cuisine type of "+e.name+" is "+e.cuisine_type+".",l.setAttributeNode(c),e.operating_hours&&fillRestaurantHoursHTML()}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");for(let n in e){const a=document.createElement("tr"),r=document.createElement("th");r.innerHTML=n;const i=document.createAttribute("scope"),o=document.createAttribute("tabindex");i.value="row",o.value=0,r.setAttributeNode(i),r.setAttributeNode(o),a.appendChild(r);const u=document.createElement("td"),d=document.createAttribute("tabindex");u.innerHTML=e[n],d.value=0,u.setAttributeNode(d),a.appendChild(u),t.appendChild(a)}}),fetchRestaurantReviewsFromURL=(e=>{if(self.reviews)return void e(null,self.reviews);const t=self.restaurant.id;t?DBHelper.fetchReviewsByRestaurantId(t,(t,n)=>{self.reviews=n,n?(fillReviewsHTML(),e(null,n)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),fillReviewsHTML=((e=self.reviews)=>{const t=document.getElementById("reviews-container"),n=document.createElement("h3"),a=document.createAttribute("tabindex");n.innerHTML="Reviews",a.value=0,n.setAttributeNode(a),t.appendChild(n);const r=document.createElement("button");r.innerHTML="Add A New Review for<br>"+self.restaurant.name;const i=document.createAttribute("id"),o=document.createAttribute("tabindex"),u=document.createAttribute("aria-label");i.value="new-review-button",o.value=0,u.value="Press button to add a new review for "+self.restaurant.name,r.setAttributeNode(i),r.setAttributeNode(o),r.setAttributeNode(u),t.appendChild(r);const d=document.createElement("form"),l=document.createAttribute("id"),c=document.createAttribute("name"),s=document.createAttribute("onsubmit");l.value="new-review-form",c.value="newReviewForm",s.value="validateNewReview()",d.setAttributeNode(l),d.setAttributeNode(l),d.setAttributeNode(c),t.appendChild(d);const m=document.getElementById("new-review-form"),b=document.createElement("p"),v=document.createAttribute("tabindex"),A=document.createAttribute("id");v.value=0,A.value="thankYou",b.setAttributeNode(v),b.setAttributeNode(A),t.appendChild(b);const p=document.createElement("label");p.innerHTML="Please enter your name:";const w=document.createAttribute("id"),g=document.createAttribute("for");w.value="newRevNameLabel",g.value="newRevName",p.setAttributeNode(w),p.setAttributeNode(g),m.appendChild(p);const h=document.createElement("input"),N=document.createAttribute("tabindex"),y=document.createAttribute("id"),f=document.createAttribute("aria-labelledby"),R=document.createAttribute("type"),E=document.createAttribute("name"),L=document.createAttribute("placeholder"),B=document.createAttribute("maxlength"),C=document.createAttribute("required");N.value=0,y.value="newRevName",f.value="newRevNameLabel",R.value="text",E.value="revname",L.value="Your Name",B.value=20,h.setAttributeNode(N),h.setAttributeNode(y),h.setAttributeNode(f),h.setAttributeNode(R),h.setAttributeNode(E),h.setAttributeNode(L),h.setAttributeNode(B),h.setAttributeNode(C),m.appendChild(h);const H=document.createElement("label");H.innerHTML="Please choose a rating:";const T=document.createAttribute("id"),k=document.createAttribute("for");T.value="newRevRatingLabel",k.value="newRevRating",H.setAttributeNode(T),H.setAttributeNode(k),m.appendChild(H);const I=document.createElement("select"),M=document.createAttribute("tabindex"),x=document.createAttribute("id"),D=document.createAttribute("name"),F=document.createAttribute("aria-labelledby");M.value=0,x.value="newRevRating",D.value="newRevRating",F.value="newRevRatingLabel",I.setAttributeNode(M),I.setAttributeNode(x),I.setAttributeNode(D),I.setAttributeNode(F),m.appendChild(I);const _=document.getElementById("newRevRating"),U=document.createElement("option"),P=document.createElement("option"),S=document.createElement("option"),Y=document.createElement("option"),j=document.createElement("option");U.innerHTML="5: Awesome!",P.innerHTML="4: Above Average",S.innerHTML="3: Average",Y.innerHTML="2: Below Average",j.innerHTML="1: Awful";const W=document.createAttribute("value"),z=document.createAttribute("value"),J=document.createAttribute("value"),O=document.createAttribute("value"),$=document.createAttribute("value"),q=document.createAttribute("selected");W.value=5,z.value=4,J.value=3,O.value=2,$.value=1,U.setAttributeNode(W),U.setAttributeNode(q),P.setAttributeNode(z),S.setAttributeNode(J),Y.setAttributeNode(O),j.setAttributeNode($),_.appendChild(U),_.appendChild(P),_.appendChild(S),_.appendChild(Y),_.appendChild(j);const K=document.createElement("label");K.innerHTML="Review Comments:";const Q=document.createAttribute("id"),V=document.createAttribute("for");Q.value="newRevCommentsLabel",V.value="newRevComments",K.setAttributeNode(Q),K.setAttributeNode(V),m.appendChild(K);const X=document.createElement("textarea"),G=document.createAttribute("tabindex"),Z=document.createAttribute("id"),ee=document.createAttribute("aria-labelledby"),te=document.createAttribute("name"),ne=document.createAttribute("maxlength");G.value=0,Z.value="newRevComments",ee.value="newRevCommentsLabel",te.value="revcomments",ne.value=250,X.setAttributeNode(G),X.setAttributeNode(Z),X.setAttributeNode(ee),X.setAttributeNode(te),X.setAttributeNode(ne),m.appendChild(X);const ae=document.createElement("button");ae.innerHTML="Submit A New Review for<br>"+self.restaurant.name;const re=document.createAttribute("id"),ie=document.createAttribute("tabindex"),oe=document.createAttribute("aria-label");if(re.value="sub-review-button",ie.value=0,oe.value="Press this button to add a new review for "+self.restaurant.name,ae.setAttributeNode(re),ae.setAttributeNode(ie),ae.setAttributeNode(oe),m.appendChild(ae),document.getElementById("new-review-button").addEventListener("click",()=>{document.getElementById("new-review-form").style.display="block",document.getElementById("new-review-button").style.display="none"}),document.getElementById("new-review-form").addEventListener("submit",e=>{e.preventDefault();const t=self.restaurant.id,n=document.getElementById("newRevName").value,a=document.getElementById("newRevRating").value,r=document.getElementById("newRevComments").value;"serviceWorker"in navigator&&"SyncManager"in window?navigator.serviceWorker.ready.then(e=>{const i={restaurant_id:t,name:n,rating:a,comments:r};console.log("newReviewData: "+JSON.stringify(i)),writeData("sync-newRev",i).then(()=>e.sync.register("sync-new-review")).then(showReviewThankYou(n)).catch(e=>console.log(e))}):sendNewReview()}),!e){const e=document.createElement("p");return e.innerHTML="No reviews yet!",void t.appendChild(e)}const ue=document.getElementById("reviews-list");e.forEach(e=>{ue.appendChild(createReviewHTML(e))}),t.appendChild(ue)}),createReviewHTML=(e=>{const t=document.createElement("li"),n=document.createElement("div"),a=document.createAttribute("class"),r=document.createAttribute("aria-label"),i=document.createAttribute("tabindex");n.innerHTML=e.name,a.value="review-name",r.value="Review by "+e.name+".",i.value=0,n.setAttributeNode(a),n.setAttributeNode(r),n.setAttributeNode(i),t.appendChild(n);const o=document.createElement("div"),u=document.createAttribute("class"),d=document.createAttribute("aria-label"),l=document.createAttribute("tabindex"),c=getFullDate(e.updatedAt);o.innerHTML=c,u.value="review-date",d.value="Review posted on "+c+".",l.value=0,o.setAttributeNode(u),o.setAttributeNode(d),o.setAttributeNode(l),t.appendChild(o);const s=document.createElement("div"),m=document.createAttribute("class"),b=document.createAttribute("aria-label"),v=document.createAttribute("tabindex");s.innerHTML=`Rating: ${e.rating}`,m.value="review-rating",b.value=e.name+" gave a rating of "+e.rating+".",v.value=0,s.setAttributeNode(m),s.setAttributeNode(b),s.setAttributeNode(v),t.appendChild(s);const A=document.createElement("p"),p=document.createAttribute("class"),w=document.createAttribute("tabindex");return A.innerHTML=e.comments,p.value="review-comments",w.value=0,A.setAttributeNode(p),A.setAttributeNode(w),t.appendChild(A),t}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}),showReviewThankYou=(e=>{document.getElementById("thankYou").innerHTML="Thank you for submitting a review "+e+"!",document.getElementById("thankYou").style.display="block",document.getElementById("new-review-form").style.display="none"}),handleLikeButtonClick=((e,t)=>{const n=document.getElementById("fave-rest-icon-"+e);self.restaurant.is_favorite=t,n.style.background=t?'url("img/icons/like.svg") no-repeat':'url("img/icons/like-not.svg") no-repeat',t?n.setAttribute("aria-label",self.restaurant.name+" is a favorite."):n.setAttribute("aria-label",self.restaurant.name+" is not a favorite."),n.onclick=(n=>handleLikeButtonClick(e,!t)),handleFaveClick(e,t)});